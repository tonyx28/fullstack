import React from 'react';
import { Link } from 'react-router';
import Modal from 'react-modal';
import ModalStyle from './modal_style';


class Friends extends React.Component {
  constructor(props){
    super(props);
    // debugger;
    this.state = { name: "", email: "", modalOpen: false };
    this.openModal = this.openModal.bind(this);
    this.closeModal = this.closeModal.bind(this);
    this.handleSubmit = this.handleSubmit.bind(this);
    this.disableDefault = this.disableDefault.bind(this);
  }
  componentDidMount() {
    this.props.fetchFriends();
  }

  handleSubmit(e) {
    e.preventDefault();
    const friend = this.state
    this.props.createFriend(friend)
  }

  openModal() {
    this.setState({ modalOpen: true });
  }

  closeModal(){
    this.setState({ modalOpen: false });
  }

  disableDefault(e){
    e.preventDefault();
  }

  render() {
    const { friends, createFriend, fetchFriends, deleteFriend } = this.props

    let friendsList;
    if (friends[0] !== undefined) {
      friendsList = friends.map(friend => (
        <a href="" className="friend" onClick={this.disableDefault}
            key={friend.id}><i className="fa fa-user" aria-hidden="true"></i>{friend.name}</a>
      ))
    }

    return(
      <div className="friends-container">
        <div className="friends-title">
          <a>FRIENDS</a>
          <a className="add-btn" onClick={this.openModal}>+add</a>
        </div>
        <Modal
          contentLabel="Modal"
          isOpen={this.state.modalOpen}
          onRequestClose={this.closeModal}
          style={ModalStyle}>
          <label>Add a friend!</label>
          <br/>
          <form className="friend-form" onSubmit={this.handleSubmit}>
            <input type="text"
                   value={this.props.name}
                   placeholder=" Enter friend's name"
                   className="friend-input" />
            <br/>
            <input type="email"
                   value={this.props.email}
                   placeholder=" Enter friend's email (optional)"
                   className="friend-input" />
            <br />
            <input className="add" type="submit" value="Add" />
          </form>
        </Modal>
        <ul className="friends-list">{friendsList}</ul>
      </div>
    )
  }
}


export default Friends;
